- question ||= @question
- search_condition ||= @search_condition
- if search_condition && search_condition.question == question
  - search_condition_operator = search_condition.operator
  - search_condition_value    = search_condition.value
  - calculated_date_number    = search_condition.calculated_date_number
  - calculated_date_units     = search_condition.calculated_date_units

.row-fluid.search-condition-answers-form
  - unless question.blank?
    .span5
      = select_tag 'search_condition[operator]', options_for_select(question_operator_options(question), search_condition_operator), class: 'input-block-level'

    .span7
      - if question.multiple_choice?
        = select_tag 'search_condition[value]', options_for_select(question.answers.collect{|a|[ a.text,a.id]}, search_condition_value), class: 'input-block-level'
      - else
        - if question.true_date?
          - display_computed_date = search_condition.blank? || search_condition.value.blank? || search_condition.is_calculated_date

          .search-condition-answer{ class: "#{'hidden' if display_computed_date }"}
            = text_field_tag 'search_condition[value]', search_condition_value, 'data-provide' => 'datepicker', class: "input-small search_condition_value #{'date' if question.true_date?}", placeholder: 'mm/dd/yyyy'
            %br
            = link_to '#', class: 'date-format-link' do
              %i.icon-refresh
              %span
                Use calculated date format

          .search-condition-answer{ class: "#{'hidden' unless display_computed_date}"}
            = text_field_tag 'search_condition[calculated_date_number]', calculated_date_number, placeholder: 'number', class: "input-mini number search_condition_value", 'data-date-value' => "#{search_condition.search_value if search_condition}"
            = select_tag 'search_condition[calculated_date_units]', options_for_select(SearchCondition::COMPUTED_DATE_UNITS.values.map{|o| [o,o]}, calculated_date_units), class: 'input-medium'
            %br
            = link_to '#', class: 'date-format-link' do
              %i.icon-refresh
              %span
                Use date format
        - else
          = text_field_tag 'search_condition[value]', search_condition_value, class: 'input-block-level search_condition_value'